<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Maintain a trip</title>
</head>
<body>
 <h1><center>Maintain a full tree</center></h1> <br>
  Expanse Name :- <input type="text" id="nm"> <br>
  Who give payment :-<br>
 a<input type="checkbox" id="a"  onchange="mypay(this)"  value="a"><input type="text" id="a1">
 b<input type="checkbox"  id="b"  onchange="mypay(this)"  value="b"><input type="text" id="b1">
 c<input type="checkbox"  id="c"   onchange="mypay(this)"  value="c"><input type="text" id="c1">
 d<input type="checkbox"  id="d"  onchange="mypay(this)"  value="d"><input type="text" id="d1">
 e<input type="checkbox"  id="e"   onchange="mypay(this)" value="e"><input type="text" id="e1"> <br>

 Who is involved in trip :-
 <input type="checkbox" id="ai" onchange="inv(this)"  value="a">a
 <input type="checkbox" id="bi" onchange="inv(this)" value="b">b
 <input type="checkbox" id="ci" onchange="inv(this)" value="c">c
 <input type="checkbox" id="di" onchange="inv(this)" value="d">d
 <input type="checkbox" id="ei" onchange="inv(this)" value="e">e  <br>
 <input type="submit" value="Submit" name="submit" onclick="sub()">  <input type="button" value="Trip Over"  onclick="trip()"> <br>  <br>
  <select id="sel" style="height: 80%" multiple="multiple"></select>  <br>
 Total expense Till now <input type="text" id="tot">
<script>
   var payper=[];
   var pay=[];
   var invo=[];
   var real=[];
   var all=[];
   var final=0;

   var totPer=["a","b","c","d","e"];
   function mypay(t) {
       var chk=t.value;
       payper.push(chk);
   }

   function inv(t) {
       var chk=t.value;
       invo.push(chk);
   }

function sub() {
    var txt=document.getElementById("nm").value;
    var a1=document.getElementById("a1").value;
    var b1=document.getElementById("b1").value;
    var c1=document.getElementById("c1").value;
    var d1=document.getElementById("d1").value;
    var e1=document.getElementById("e1").value;
    if(a1!="") pay.push(a1);
    if(b1!="") pay.push(b1);
    if(c1!="") pay.push(c1);
    if(d1!="") pay.push(d1);
    if(e1!="") pay.push(e1);

    var tot=Number(a1)+Number(b1)+Number(c1)+Number(d1)+Number(e1);
    final+=tot;
    var a=tot/invo.length;
   for(i=0;i<invo.length;i++){
       real.push(a);
   }
    document.getElementById("tot").value=final;

    var obj={
         "totPer":totPer,
         "expName":txt,
         "personGive":payper,
         "givenPay":pay,
         "personUse":invo,
         "realExp":real,
         "tot":tot
    };
    all.push(obj);
    console.log(all);

    var sel=document.getElementById("sel");
    var opt=document.createElement("option");
    opt.text=txt+" "+tot;
    opt.value=txt+" "+tot;
    sel.add(opt);
   dataclear();
}
function dataclear() {
    payper=[];
     pay=[];
     invo=[];
     real=[];

    document.getElementById("nm").value="";
    document.getElementById("a1").value="";
    document.getElementById("b1").value="";
    document.getElementById("c1").value="";
    document.getElementById("d1").value="";
    document.getElementById("e1").value="";

    document.getElementById("a").checked=false;
    document.getElementById("b").checked=false;
    document.getElementById("c").checked=false;
    document.getElementById("d").checked=false;
    document.getElementById("e").checked=false;

    document.getElementById("ai").checked=false;
    document.getElementById("bi").checked=false;
    document.getElementById("ci").checked=false;
    document.getElementById("di").checked=false;
    document.getElementById("ei").checked=false;
}

function trip() {

    var atot = 0, btot = 0, ctot = 0, dtot = 0, etot = 0;
    var ause = 0, buse = 0, cuse = 0, duse = 0, euse = 0;
    var af = 0, bf = 0, cf = 0, df = 0, ef = 0;
    var am = 0, bm = 0, cm = 0, dm = 0, em = 0;
    var a = [];

    for (var i = 0; i < all.length; i++) {

        if (all[i].totPer[0] == "a") {
            for (j = 0; j < all[i].personGive.length; j++) {
                if (all[i].personGive[j] == "a") {
                    atot += Number(all[i].givenPay[j]);
                }
            }
            for (j = 0; j < all[i].personUse.length; j++) {
                if (all[i].personUse[j] == "a") {
                    ause += Number(all[i].realExp[j]);
                }
            }
        }

        if (all[i].totPer[1] == "b") {
            for (j = 0; j < all[i].personGive.length; j++) {
                if (all[i].personGive[j] == "b") {
                    btot += Number(all[i].givenPay[j]);
                }
            }
            for (j = 0; j < all[i].personUse.length; j++) {
                if (all[i].personUse[j] == "b") {
                    buse += Number(all[i].realExp[j]);
                }
            }
        }

        if (all[i].totPer[2] == "c") {
            for (j = 0; j < all[i].personGive.length; j++) {
                if (all[i].personGive[j] == "c") {
                    ctot += Number(all[i].givenPay[j]);
                }
            }
            for (j = 0; j < all[i].personUse.length; j++) {
                if (all[i].personUse[j] == "c") {
                    cuse += Number(all[i].realExp[j]);
                }
            }
        }

        if (all[i].totPer[3] == "d") {
            for (j = 0; j < all[i].personGive.length; j++) {
                if (all[i].personGive[j] == "d") {
                    dtot += Number(all[i].givenPay[j]);
                }
            }
            for (j = 0; j < all[i].personUse.length; j++) {
                if (all[i].personUse[j] == "d") {
                    duse += Number(all[i].realExp[j]);
                }
            }
        }

        if (all[i].totPer[4] == "e") {
            for (j = 0; j < all[i].personGive.length; j++) {
                if (all[i].personGive[j] == "e") {
                    etot += Number(all[i].givenPay[j]);
                }
            }
            for (j = 0; j < all[i].personUse.length; j++) {
                if (all[i].personUse[j] == "e") {
                    euse += Number(all[i].realExp[j]);
                }
            }
        }
    }

    af = atot - ause;
    bf = btot - buse;
    cf = ctot - cuse;
    df = dtot - duse;
    ef = etot - euse;

    console.log(af+"  "+bf+" "+cf+"  "+df+"  "+ef);

    if (af > 0) {
        var html = "person A paid =" + af + "And take from   ";
        if (af> 0 && bf < 0) {
            am=af+ bf;
            if(am>0){
                html += "b=" +Math.abs(bf);
                af+=bf;
                bf=0;
            }
            if(am<0){
                html += "b=" +Math.abs(af);
                bf+=af;
                af=0;
            }
            if(am==0){
                html += "b=" + Math.abs(bf);
                bf=0;
                af=0;
            }

        }
        if (af > 0 && cf < 0) {
            am=af+ cf;
            if(am>0){
                html += "c=" + Math.abs(cf);
                af+=cf;
                cf=0;
            }
            if(am<0){
                html += "c=" +Math.abs(af) ;
                cf+=af;
                af=0;
            }
            if(am==0){
                html += "c=" +Math.abs(cf);
                cf=0;
                af=0;
            }
        }
        if (af > 0 && df < 0) {
            am=af+ df;
            if(am>0){
                html += "d=" +Math.abs(df);
                af+=df;
                df=0;
            }
            if(am <0){
                html += "d=" +Math.abs(af);
                df+=af;
                af=0;
            }
            if(am==0){
                html += "d=" + Math.abs(df);
                df=0;
                af=0;
            }
        }
        if (af > 0 && ef < 0) {
            am=af+ ef;
            if(am>0){
                html += "e=" + Math.abs(ef);
                af+=ef;
                ef=0;
            }
            if(am <0){
                html += "e=" +Math.abs(af);
                ef+=af;
                af=0
            }
            if(am==0){
               html += "e=" +Math.abs(ef);
                ef=0;
                af=0;
            }
        }
        console.log(html);
    }

    if (bf > 0) {
        var html = "person B paid =" + bf + "And take from    ";
        if (bf > 0 && cf < 0) {
            bm=bf+ cf;
            if(bm>0){
                html += "c=" + Math.abs(cf);
                bf += cf;
                cf=0;
            }
            if(bm <=0){
                html += "c=" + Math.abs(bf);
                cf+=bf;
                bf=0;
            }
            if(bm==0){
                html += "c=" + Math.abs(cf);
                bf=0;
                cf=0;
            }
        }

        if (bf > 0 && df < 0) {
            bm=bf+ df;
            if(bm>0){
                html += "d=" +Math.abs(df);
                bf += df;
                df=0;
            }
            if(bm <=0){
                html += "d=" +Math.abs(bf);
                df+=bf;
                bf=0;
            }
            if(bm==0){
                html += "d=" + Math.abs(df);
                bf=0;
                df=0;
            }
        }
        if (bf > 0 && ef < 0) {
            bm=bf+ ef;
            if(bm>0){
                html += "e=" + Math.abs(ef);
                bf += ef;
               ef=0;
            }
            if(bm <=0){
                html += "e=" + Math.abs(bf);
                ef+=bf;
               bf=0;
            }
            if(bm==0){
                html += "e=" + Math.abs(ef);
                bf=0;
                ef=0;
            }
        }

        if (bf > 0 && af < 0) {
            bm=bf+ af;
            if(bm>0){
                html += "a=" + Math.abs(af);
                bf += af;
                af=0;
            }
            if(bm <=0){
                html += "a=" +Math.abs(bf);
                af+=bf;
                bf=0;
            }
            if(bm==0){
                html += "a=" + Math.abs(af);
                bf=0;
                af=0;
            }
        }
        console.log(html);
    }

    if (cf > 0) {
        var html = "person C paid =" + cf + "And take from  ";

        if (cf > 0 && af < 0) {
            cm=cf+ af;
            if(cm>0){
                html += "a=" + Math.abs(af);
                cf += af;
                af=0;
            }
            if(cm <=0){
                html += "a=" + Math.abs(cf);
                af+=cf;
                cf=0;
            }
            if(cm==0){
                html += "a=" + Math.abs(af);
                af=0;
                cf=0;
            }
        }

        if (cf > 0 && bf < 0) {
            cm=cf+ bf;
            if(cm>0){
                html += "b=" + Math.abs(bf);
                cf += bf;
                bf=0;
            }
            if(cm <=0){
                html += "b=" + Math.abs(cf);
                bf+=cf;
                cf=0;
            }
            if(cm==0){
                html += "b=" + Math.abs(bf);
                bf=0;
                cf=0;
            }
        }

        if (cf > 0 && df < 0) {
            cm=cf+ df;
            if(cm>0){
                html += "d=" + Math.abs(df);
                cf += df;
                df=0;
            }
            if(cm <=0){
                html += "d=" + Math.abs(cf);
                df+=cf;
                cf=0;
            }
            if(cm==0){
                html += "d=" + Math.abs(df);
                df=0;
                cf=0;
            }
        }

        if (cf > 0 && ef < 0) {
            cm=cf+ ef;
            if(cm>0){
                html += "e=" + Math.abs(ef);
                cf += ef;
                ef=0;
            }
            if(cm <=0){
                html += "e=" + Math.abs(cf);
                ef+=cf;
                cf=0;
            }
            if(cm==0){
                html += "e=" + Math.abs(ef);
                ef=0;
                cf=0;
            }
        }
        console.log(html);

    }


    if (df > 0) {
        var html = "person d paid =" + df + "And take from  ";

        if (df > 0 && ef < 0) {
            dm=df+ ef;
            if(dm>0){
                html += "e=" + Math.abs(ef);
                df += ef;
                ef=0;
            }
            if(dm <=0){
                html += "e=" + Math.abs(df);
                ef+=df;
                df=0;
            }
            if(dm==0){
               html += "e=" + Math.abs(ef);
                ef=0;
                df=0;
            }
        }


        if (df > 0 && af < 0) {
            dm=df+ af;
            if(dm>0){
                html += "a=" + Math.abs(af);
                df += af;
                af=0;
            }
            if(dm <=0){
                html += "a=" + Math.abs(df);
                af+=df;
                df=0;
            }
            if(dm==0){
                html += "a=" + Math.abs(af);
                af=0;
                df=0;
            }
        }


        if (df > 0 && bf < 0) {
            dm=df+ af;
            if(dm>0){
                html += "b=" + Math.abs(bf);
                df += bf;
                bf=0;
            }
            if(dm <=0){
                html += "b=" + Math.abs(df);
                bf+=df;
                df=0;
            }
            if(dm==0){
                html += "b=" + Math.abs(bf);
                bf=0;
                df=0;
            }
        }

        if (df > 0 && cf < 0) {
            dm=df+ cf;
            if(dm>0){
                html += "c=" + Math.abs(cf);
                df += cf;
                cf=0;
            }
            if(dm <=0){
                html += "c=" + Math.abs(df);
                cf+=df;
                df=0;
            }
            if(dm==0){
                html += "c=" + Math.abs(cf);
                cf=0;
                df=0;
            }
        }
        console.log(html);
    }

    if (ef > 0) {
        var html = "person E paid =" + ef + "And take from  ";

        if (ef > 0 && af < 0) {
            em=ef+ af;
            if(em>0){
                html += "a=" + Math.abs(af);
                ef += af;
                af=0;
            }
            if(dm <=0){
                html += "a=" + Math.abs(ef);
                af+=ef;
                ef=0;
            }
            if(em==0){
               html += "a=" + Math.abs(af);
                af=0;
                ef=0;
            }
        }

        if (ef > 0 && bf < 0) {
            em=ef+ bf;
            if(em>0){
                html += "b=" + Math.abs(bf);
                ef += bf;
                bf=0;
            }
            if(dm <=0){
                html += "b=" + Math.abs(ef);
                bf+=ef;
                ef=0;
            }
            if(em==0){
               html += "b=" + Math.abs(bf);
                bf=0;
                ef=0;
            }
        }

        if (ef > 0 && cf < 0) {
            em=ef+ cf;
            if(em>0){
                html += "c=" + Math.abs(cf);
                ef += cf;
                cf=0;
            }
            if(dm <=0){
                html += "c=" + Math.abs(ef);
                cf+=ef;
                ef=0;
            }
            if(em==0){
               html += "c=" + Math.abs(cf);
                cf=0;
                ef=0;
            }
        }

        if (ef > 0 && df < 0) {
            em=ef+ df;
            if(em>0){
                html += "d=" + Math.abs(df);
                ef += df;
                df=0;
            }
            if(dm <=0){
                html += "d=" + Math.abs(ef);
                df+=ef;
                ef=0;
            }
            if(em==0){
               html += "d=" + Math.abs(df);
                df=0;
                ef=0;
            }
        }

        console.log(html);
     }
}
</script>
</body>
</html>


